@model IEnumerable<Asiservy.Automatizacion.Datos.Datos.spReporteEvaluacionProductoEnfundado>

@{
    int reg = Model.Count() + 1;
    decimal Promedio = Convert.ToDecimal(Model.Sum(z => z.SumaScorch) / Model.Count());
}
<div class="card">
    <div class="row">
        
        <div class="col-md-12 table-responsive" >
            <div style="padding-bottom:10px;" id="DivBotonImpr">
                <button data-toggle="tooltip" data-placement="top" title="Imprimir" class="btn" id="btnimprimir" onclick="imprimirw()" style="border-color:#2c3e50" type="button">
                    <img style="width:100%" src="~/Content/icons/print24.png" />
                </button><br />

            </div>
            <table class="table table-bordered" id="tablaCab">
                <tbody>
                    <tr>
                        <td colspan="8">
                            <strong>FECHA DE PRODUCCIÓN: </strong>  @Model.FirstOrDefault().FechaProduccion.Value.ToString("yyyy/MM/dd")
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2"><strong>NIVEL DE LIMPIEZA</strong></td>
                        <td colspan="2"><strong>TIPO DE PRODUCTO</strong></td>
                        <td><strong>CLIENTE:</strong></td>
                        <td>@Model.FirstOrDefault().Cliente</td>
                        <td colspan="2">TRAZABILIDAD DEL EMAPQUE</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>
                            @if (Model.FirstOrDefault().TipoLimpieza == "Sencilla")
                            {
                                <i class="fas fa-check"></i>
                            }
                        </td>
                        <td><strong>LOMOS</strong></td>
                        <td>
                            @if (Model.FirstOrDefault().Lomo == true)
                            {
                                <i class="fas fa-check"></i>
                            }
                        </td>
                        <td><strong>MARCA</strong></td>
                        <td>@Model.First().Marca</td>
                        <td><strong>PROVEEDOR</strong></td>
                        <td>@Model.First().Proveedor</td>

                    </tr>
                    <tr>
                        <td>
                            1 1/2
                        </td>
                        <td>
                            @if (Model.FirstOrDefault().TipoLimpieza == "Intermedia")
                            {
                                <i class="fas fa-check"></i>
                            }
                        </td>
                        <td>
                            <strong>TROZOS</strong>
                        </td>
                        <td>
                            @if (Model.FirstOrDefault().Trozo == true)
                            {
                                <i class="fas fa-check"></i>
                            }
                        </td>
                        <td>
                            <strong>DESTINO</strong>
                        </td>
                        <td>
                            @Model.FirstOrDefault().Destino
                        </td>
                        <td>
                            <strong>Batch</strong>
                        </td>
                        <td>
                            @Model.FirstOrDefault().Batch
                        </td>
                    </tr>
                    <tr>
                        <td>
                            2
                        </td>
                        <td>
                            @if (Model.FirstOrDefault().TipoLimpieza == "Doble")
                            {
                                <i class="fas fa-check"></i>
                            }
                        </td>
                        <td><strong>MIGAS</strong></td>
                        <td>
                            @if (Model.FirstOrDefault().Miga == true)
                            {
                                <i class="fas fa-check"></i>
                            }
                        </td>
                        <td>
                            <strong>OP:</strong>
                        </td>
                        <td>
                            @Model.FirstOrDefault().OrdenFabricacion
                        </td>
                        <td><strong>LOTE</strong></td>
                        <td>@Model.FirstOrDefault().Lote</td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-bordered" id="tblReporte">

                <tbody>
                    <tr>
                        <td colspan="@reg" class="text-center"><strong>INFORMACIÓN GENERAL LOTES</strong></td>
                    </tr>
                    <tr>

                        <td>Hora de Inspección</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Hora</td>
                        }
                    </tr>
                    <tr>
                        <td>Buque Pesquero</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.buque</td>
                        }
                    </tr>
                    <tr>
                        <td>Lote</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Lote</td>
                        }
                    </tr>
                    <tr>
                        <td>Empacador/a</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.NOMBRES</td>
                        }
                    </tr>
                    <tr>

                        <td colspan="@reg" class="text-center"><strong>EVALUACIÓN ORGANOLÉPTICA</strong></td>
                    </tr>
                    <tr>
                        <td>Sabor</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Sabor</td>
                        }
                    </tr>
                    <tr>
                        <td>Textura</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Textura</td>
                        }
                    </tr>
                    <tr>
                        <td>Color</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Color</td>
                        }
                    </tr>
                    <tr>
                        <td>Olor</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Olor</td>
                        }
                    </tr>
                    <tr>
                        <td>Moretones</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Moretones</td>
                        }
                    </tr>
                    <tr>
                        <td>Hematomas profundos</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.HematomasProfundos</td>
                        }
                    </tr>
                    <tr>
                        <td>Proteínas</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Proteinas</td>
                        }
                    </tr>
                    <tr>
                        <td>Trozos</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.TrozoPorcentaje</td>
                        }
                    </tr>
                    <tr>
                        <td>Migas</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.MigaPorcentaje</td>
                        }
                    </tr>
                    <tr>
                        <td colspan="@reg" class="text-center"><strong>VERIFICACIÓN DE LIMPIEZA</strong></td>
                    </tr>
                    <tr>
                        <td>Venas</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Venas</td>
                        }
                    </tr>
                    <tr>
                        <td>Espinas</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Espinas</td>
                        }
                    </tr>
                    <tr>
                        <td>Sangre</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Sangre</td>
                        }
                    </tr>
                    <tr>
                        <td>Escamas</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Escamas</td>
                        }
                    </tr>
                    <tr>
                        <td>Piel</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Piel</td>
                        }
                    </tr>
                    <tr>
                        <td>Otros</td>
                        @foreach (var item in Model)
                        {
                            <td>@item.Otro</td>
                        }
                    </tr>
                    <tr>
                        <td>TOTAL INDIVIDUAL</td>
                        @foreach (var item in Model)
                        {
                            int? suma = 0;
                            suma = item.Venas + item.Espinas + item.Sangre + item.Escamas + item.Piel + item.Otro;
                            <td>@suma</td>
                        }
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td>
                            TOTAL GENERAL
                        </td>
                        <td colspan="@reg">
                            @Model.Sum(x => x.SumaScorch)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            PROMEDIO
                        </td>
                        <td colspan="@reg">
                            @Promedio
                        </td>
                    </tr>
                    <tr>
                        <td>
                            OBSERVACIONES:
                        </td>
                        <td colspan="@reg">
                            @Model.FirstOrDefault().Observacion
                        </td>
                    </tr>
                </tfoot>
            </table>
            @{
                string FirmaControl = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAADICAIAAABJdyC1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKJSURBVHhe7dQBDQAADMOg+ze962gCIrgBRAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAiK2BzRODTv+VPxzAAAAAElFTkSuQmCC";
                string FirmaAprobacion = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAADICAIAAABJdyC1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKJSURBVHhe7dQBDQAADMOg+ze962gCIrgBRAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAjKEBWQIC8gQFpAhLCBDWECGsIAMYQEZwgIyhAVkCAvIEBaQISwgQ1hAhrCADGEBGcICMoQFZAgLyBAWkCEsIENYQIawgAxhARnCAiK2BzRODTv+VPxzAAAAAElFTkSuQmCC";
                if (Model.FirstOrDefault().FirmaControl != null)
                {
                    var base64 = Convert.ToBase64String(Model.FirstOrDefault().FirmaControl);
                    FirmaControl = String.Format("data:image/png;base64,{0}", base64);
                }
                if (Model.FirstOrDefault().FirmaAprobacion != null)
                {
                    var base64 = Convert.ToBase64String(Model.FirstOrDefault().FirmaAprobacion);
                    FirmaAprobacion = String.Format("data:image/png;base64,{0}", base64);
                }

            }
            <center>
                <table id="TablaFirmas">
                    <tbody>
                        <tr>
                            <td class="text-center">
                                <img src="@FirmaControl" id="firma1" width="200" height="100" />
                                <br />
                                Realizado Por
                            </td>
                            <td class="text-center">
                                <img src="@FirmaAprobacion" id="firma2" width="200" height="100" />
                                <br />
                                Revisado Por
                            </td>
                        </tr>
                    </tbody>

                </table>
            </center>
        </div>
    </div>
</div>
